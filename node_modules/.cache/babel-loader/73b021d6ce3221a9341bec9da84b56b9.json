{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Lisp/Desktop/items/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _toConsumableArray from \"C:/Users/Lisp/Desktop/items/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.match-all.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.string.match.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getArticleById } from \"@/api/getListApi\";\nimport { ImagePreview } from \"vant\";\nimport { createLogger } from 'vuex';\nexport default {\n  name: \"ArticleIndex\",\n  components: {},\n  props: {\n    article_id: {\n      type: [Number, String],\n      required: true\n    }\n  },\n  data: function data() {\n    return {\n      article: {},\n      loading: true,\n      errStatus: 0\n    };\n  },\n  computed: {\n    imagelist: function imagelist() {\n      var reg = /<img (.)+\\/>/gi; // '<img src=\"https://img2018.cnblogs.com/blog/680284/…84-20181008144152656-1737502385.png\" alt=\"\"/></p>\n\n      var result = this.article.content.matchAll(reg);\n      console.log(result);\n\n      _toConsumableArray(result).forEach(function (img) {\n        console.log(img);\n      });\n\n      return this.article.content.match(reg);\n    }\n  },\n  watch: {},\n  created: function created() {\n    this.getArticleInfo();\n  },\n  mounted: function mounted() {},\n  updated: function updated() {\n    console.log(this.imagelist); // this.$nextTick(() => {\n    // let imgs = this.$refs[\"contentInfo\"].querySelectorAll(\"img\");\n    // setTimeout(() => {\n    //     console.log(imgs.contentInfo);\n    // });\n    //   \n    //    console.log(imgs);\n    // });\n  },\n  methods: {\n    getArticleInfo: function getArticleInfo() {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _yield$getArticleById, data;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _this.loading = true;\n                _context.prev = 1;\n                _context.next = 4;\n                return getArticleById(_this.article_id);\n\n              case 4:\n                _yield$getArticleById = _context.sent;\n                data = _yield$getArticleById.data;\n                // if(Math.random()>0.5){\n                //     JSON.parse(\"a11122a13a131a31daj\")\n                // }\n                _this.article = data.data;\n                _context.next = 12;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](1);\n\n                // console.log(err);\n                if (_context.t0.response && _context.t0.response.status == 404) {\n                  _this.errStatus = 404;\n\n                  _this.$toast(\"请求数据出错,请稍后重试\");\n                } // console.log(err.response);\n                // console.log(err.request);\n\n\n              case 12:\n                _this.loading = false;\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[1, 9]]);\n      }))();\n    },\n    goBack: function goBack() {\n      // console.log(this.$router);\n      this.$router.back();\n    },\n    getImages: function getImages() {}\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqFA;AACA;AACA;AAEA;AACAA,sBADA;AAEAC,gBAFA;AAGAC;AACAC;AACAC,4BADA;AAEAC;AAFA;AADA,GAHA;AASAC,MATA,kBASA;AACA;AACAC,iBADA;AAEAC,mBAFA;AAGAC;AAHA;AAKA,GAfA;AAgBAC;AACAC,aADA,uBACA;AACA,iCADA,CAGA;;AAEA;AAEAC;;AACA;AACAA;AACA,OAFA;;AAGA;AACA;AAbA,GAhBA;AA+BAC,WA/BA;AAgCAC,SAhCA,qBAgCA;AACA;AACA,GAlCA;AAmCAC,SAnCA,qBAmCA,CAEA,CArCA;AAsCAC,SAtCA,qBAsCA;AACAJ,gCADA,CAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAjDA;AAkDAK;AACAC,kBADA,4BACA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA,uBAGAC,gCAHA;;AAAA;AAAA;AAGAb,oBAHA,yBAGAA,IAHA;AAIA;AACA;AACA;AACA;AAPA;AAAA;;AAAA;AAAA;AAAA;;AASA;AACA;AACA;;AACA;AACA,iBAbA,CAcA;AACA;;;AAfA;AAiBA;;AAjBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkBA,KAnBA;AAoBAc,UApBA,oBAoBA;AACA;AACA;AACA,KAvBA;AAwBAC,aAxBA,uBAwBA,CAEA;AA1BA;AAlDA","names":["name","components","props","article_id","type","required","data","article","loading","errStatus","computed","imagelist","console","watch","created","mounted","updated","methods","getArticleInfo","getArticleById","goBack","getImages"],"sourceRoot":"src/views/Article","sources":["index.vue"],"sourcesContent":["<template>\r\n    <div class=\"article-container\">\r\n        <!-- 导航栏 -->\r\n        <van-nav-bar @click-left=\"goBack\" class=\"page-nav-bar\" left-arrow title=\"黑马头条\"></van-nav-bar>\r\n        <!-- /导航栏 -->\r\n\r\n        <div class=\"main-wrap\">\r\n            <!-- 加载中 -->\r\n            <div v-if=\"loading\" class=\"loading-wrap\">\r\n                <van-loading color=\"#3296fa\" vertical>加载中</van-loading>\r\n            </div>\r\n            <!-- /加载中 -->\r\n\r\n            <!-- 加载完成-文章详情 -->\r\n            <div v-else-if=\"article.title\" class=\"article-detail\">\r\n                <!-- 文章标题 -->\r\n                <h1 class=\"article-title\">{{article.title}}</h1>\r\n                <!-- /文章标题 -->\r\n\r\n                <!-- 用户信息 -->\r\n                <van-cell class=\"user-info\" center :border=\"false\">\r\n                    <van-image\r\n                        class=\"avatar\"\r\n                        slot=\"icon\"\r\n                        round\r\n                        fit=\"cover\"\r\n                        :src=\"article.aut_photo\"\r\n                    />\r\n                    <div slot=\"title\" class=\"user-name\">{{article.aut_name}}</div>\r\n                    <div slot=\"label\" class=\"publish-date\">{{article.pubdate | relativeTime}}</div>\r\n                    <van-button\r\n                        class=\"follow-btn\"\r\n                        type=\"info\"\r\n                        color=\"#3296fa\"\r\n                        round\r\n                        size=\"small\"\r\n                        icon=\"plus\"\r\n                    >关注</van-button>\r\n                    <!-- <van-button\r\n            class=\"follow-btn\"\r\n            round\r\n            size=\"small\"\r\n                    >已关注</van-button>-->\r\n                </van-cell>\r\n                <!-- /用户信息 -->\r\n\r\n                <!-- 文章内容 -->\r\n                <div\r\n                    ref=\"contentInfo\"\r\n                    class=\"article-content markdown-body\"\r\n                    v-html=\"article.content\"\r\n                ></div>\r\n                <van-divider>正文结束</van-divider>\r\n            </div>\r\n            <!-- /加载完成-文章详情 -->\r\n\r\n            <!-- 加载失败：404 -->\r\n            <div v-else-if=\"errStatus === 404\" class=\"error-wrap\">\r\n                <van-icon name=\"failure\" />\r\n                <p class=\"text\">该资源不存在或已删除！</p>\r\n            </div>\r\n            <!-- /加载失败：404 -->\r\n\r\n            <!-- 加载失败：其它未知错误（例如网络原因或服务端异常） -->\r\n            <div v-else class=\"error-wrap\">\r\n                <van-icon name=\"failure\" />\r\n                <p class=\"text\">内容加载失败！</p>\r\n                <van-button class=\"retry-btn\" @click=\"getArticleInfo\">点击重试</van-button>\r\n            </div>\r\n            <!-- /加载失败：其它未知错误（例如网络原因或服务端异常） -->\r\n        </div>\r\n\r\n        <!-- 底部区域 -->\r\n        <div class=\"article-bottom\">\r\n            <van-button class=\"comment-btn\" type=\"default\" round>写评论</van-button>\r\n            <van-icon name=\"comment-o\" badge=\"123\" color=\"#777\" />\r\n            <van-icon color=\"#777\" name=\"star-o\" />\r\n            <van-icon color=\"#777\" name=\"good-job-o\" />\r\n            <van-icon name=\"share\" color=\"#777777\"></van-icon>\r\n        </div>\r\n        <!-- /底部区域 -->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { getArticleById } from \"@/api/getListApi\";\r\nimport { ImagePreview } from \"vant\";\r\nimport { createLogger } from 'vuex';\r\n\r\nexport default {\r\n    name: \"ArticleIndex\",\r\n    components: {},\r\n    props: {\r\n        article_id: {\r\n            type: [Number, String],\r\n            required: true,\r\n        },\r\n    },\r\n    data() {\r\n        return {\r\n            article: {},\r\n            loading: true,\r\n            errStatus: 0,\r\n        };\r\n    },\r\n    computed: {\r\n        imagelist(){\r\n            let reg = /<img (.)+\\/>/gi;\r\n\r\n    // '<img src=\"https://img2018.cnblogs.com/blog/680284/…84-20181008144152656-1737502385.png\" alt=\"\"/></p>\r\n\r\n            let result =  this.article.content.matchAll(reg);\r\n\r\n            console.log(result);\r\n            [...result].forEach(img => {\r\n                console.log(img);\r\n            });\r\n            return this.article.content.match(reg);\r\n        }\r\n    },\r\n    watch: {},\r\n    created() {\r\n        this.getArticleInfo();\r\n    },\r\n    mounted() {\r\n        \r\n    },\r\n    updated(){\r\n                    console.log(this.imagelist);\r\n\r\n        // this.$nextTick(() => {\r\n            // let imgs = this.$refs[\"contentInfo\"].querySelectorAll(\"img\");\r\n            // setTimeout(() => {\r\n            //     console.log(imgs.contentInfo);\r\n            // });\r\n            //   \r\n            //    console.log(imgs);\r\n        // });\r\n    },\r\n    methods: {\r\n        async getArticleInfo() {\r\n            this.loading = true;\r\n            try {\r\n                const { data } = await getArticleById(this.article_id);\r\n                // if(Math.random()>0.5){\r\n                //     JSON.parse(\"a11122a13a131a31daj\")\r\n                // }\r\n                this.article = data.data;\r\n            } catch (err) {\r\n                // console.log(err);\r\n                if (err.response && err.response.status == 404) {\r\n                    this.errStatus = 404;\r\n                    this.$toast(\"请求数据出错,请稍后重试\");\r\n                }\r\n                // console.log(err.response);\r\n                // console.log(err.request);\r\n            }\r\n            this.loading = false;\r\n        },\r\n        goBack() {\r\n            // console.log(this.$router);\r\n            this.$router.back();\r\n        },\r\n        getImages(){\r\n            \r\n        }\r\n    },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import url(\"./github-markdown.css\");\r\n\r\n.article-container {\r\n    .main-wrap {\r\n        position: fixed;\r\n        left: 0;\r\n        right: 0;\r\n        top: 92px;\r\n        bottom: 88px;\r\n        overflow-y: scroll;\r\n        background-color: #fff;\r\n    }\r\n    .article-detail {\r\n        .article-title {\r\n            font-size: 40px;\r\n            padding: 50px 32px;\r\n            margin: 0;\r\n            color: #3a3a3a;\r\n        }\r\n\r\n        .user-info {\r\n            padding: 0 32px;\r\n            .avatar {\r\n                width: 70px;\r\n                height: 70px;\r\n                margin-right: 17px;\r\n            }\r\n            .van-cell__label {\r\n                margin-top: 0;\r\n            }\r\n            .user-name {\r\n                font-size: 24px;\r\n                color: #3a3a3a;\r\n            }\r\n            .publish-date {\r\n                font-size: 23px;\r\n                color: #b7b7b7;\r\n            }\r\n            .follow-btn {\r\n                width: 170px;\r\n                height: 58px;\r\n            }\r\n        }\r\n\r\n        .article-content {\r\n            padding: 55px 32px;\r\n            /deep/ p {\r\n                text-align: justify;\r\n            }\r\n        }\r\n    }\r\n\r\n    .loading-wrap {\r\n        padding: 200px 32px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        background-color: #fff;\r\n    }\r\n\r\n    .error-wrap {\r\n        padding: 200px 32px;\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: center;\r\n        justify-content: center;\r\n        background-color: #fff;\r\n        .van-icon {\r\n            font-size: 122px;\r\n            color: #b4b4b4;\r\n        }\r\n        .text {\r\n            font-size: 30px;\r\n            color: #666666;\r\n            margin: 33px 0 46px;\r\n        }\r\n        .retry-btn {\r\n            width: 280px;\r\n            height: 70px;\r\n            line-height: 70px;\r\n            border: 1px solid #c3c3c3;\r\n            font-size: 30px;\r\n            color: #666666;\r\n        }\r\n    }\r\n\r\n    .article-bottom {\r\n        position: fixed;\r\n        left: 0;\r\n        right: 0;\r\n        bottom: 0;\r\n        display: flex;\r\n        justify-content: space-around;\r\n        align-items: center;\r\n        box-sizing: border-box;\r\n        height: 88px;\r\n        border-top: 1px solid #d8d8d8;\r\n        background-color: #fff;\r\n        .comment-btn {\r\n            width: 282px;\r\n            height: 100%;\r\n            border: 2px solid #eeeeee;\r\n            font-size: 30px;\r\n            line-height: 46px;\r\n            color: #a7a7a7;\r\n        }\r\n        .van-icon {\r\n            font-size: 40px;\r\n            .van-info {\r\n                font-size: 16px;\r\n                background-color: #e22829;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}