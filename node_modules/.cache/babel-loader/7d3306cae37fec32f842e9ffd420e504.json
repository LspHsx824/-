{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Lisp/Desktop/items/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"C:/Users/Lisp/Desktop/items/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"regenerator-runtime/runtime.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState } from \"vuex\";\nimport { getUserinfo } from \"../../api/users\";\nexport default {\n  name: \"my-info\",\n  data: function data() {\n    return {\n      userInfo: {}\n    };\n  },\n  computed: _objectSpread({}, mapState([\"user\"])),\n  methods: {\n    onLogout: function onLogout() {\n      var _this = this;\n\n      this.$dialog.confirm({\n        title: \"退出登录\"\n      }).then(function () {\n        // on confirm\n        _this.$store.commit(\"setUser\", null);\n      }).catch(function () {// on cancel\n      });\n    },\n    loadUserInfo: function loadUserInfo() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _yield$getUserinfo, data;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return getUserinfo();\n\n              case 3:\n                _yield$getUserinfo = _context.sent;\n                data = _yield$getUserinfo.data;\n                _this2.userInfo = data.data;\n                console.log(_this2.userInfo);\n                _context.next = 12;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](0);\n\n                _this2.$toast(\"获取数据失败，未知错误\");\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 9]]);\n      }))();\n    }\n  },\n  created: function created() {\n    if (this.user) this.loadUserInfo();\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;AACA;AAEA;AACAA,iBADA;AAEAC,MAFA,kBAEA;AACA;AACAC;AADA;AAGA,GANA;AAOAC,8BACAC,kBADA,CAPA;AAUAC;AACAC,YADA,sBACA;AAAA;;AACA;AACAC;AADA,SAEAC,IAFA,CAEA;AACA;AACA;AACA,OALA,EAMAC,KANA,CAMA,aACA;AACA,OARA;AASA,KAXA;AAYAC,gBAZA,0BAYA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEAC,aAFA;;AAAA;AAAA;AAEAV,oBAFA,sBAEAA,IAFA;AAGA;AACAW;AAJA;AAAA;;AAAA;AAAA;AAAA;;AAMA;;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AApBA,GAVA;AAiCAC,SAjCA,qBAiCA;AACA;AACA;AAnCA","names":["name","data","userInfo","computed","mapState","methods","onLogout","title","then","catch","loadUserInfo","getUserinfo","console","created"],"sourceRoot":"src/views/my","sources":["my.vue"],"sourcesContent":["<template>\r\n    <div class=\"my-container\">\r\n        <!-- 用户登录注册 -->\r\n        <div v-if=\"!user\" class=\"header not-login\">\r\n            <div class=\"login\">\r\n                <img src=\"../../assets/mobile.png\" alt=\"登录\" @click=\"$router.push('/login')\" />\r\n                <span class=\"text\">登录 / 注册</span>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 用户基本信息面板 -->\r\n        <div v-else class=\"user-card\">\r\n            <!-- 用户头像、姓名 -->\r\n            <van-cell>\r\n                <!-- 使用 title 插槽来自定义标题 -->\r\n                <template #icon>\r\n                    <!-- <img src=\"../../assets/logo.png\" alt class=\"avatar\" /> -->\r\n                    <van-image\r\n                        width=\"40\"\r\n                        height=\"40\"\r\n                        fit=\"cover\"\r\n                        class=\"avatar\"\r\n                        round\r\n                        :src=\"userInfo.photo\"\r\n                    />\r\n                </template>\r\n                <template #title>\r\n                    <span class=\"username\">{{userInfo.name}}</span>\r\n                </template>\r\n                <template #label>\r\n                    <van-tag color=\"#fff\" text-color=\"#007bff\">申请认证</van-tag>\r\n                </template>\r\n            </van-cell>\r\n            <!-- 动态、关注、粉丝 -->\r\n            <div class=\"user-data\">\r\n                <div class=\"user-data-item\">\r\n                    <span>{{ userInfo.art_count }}</span>\r\n                    <span>动态</span>\r\n                </div>\r\n                <div class=\"user-data-item\">\r\n                    <span>{{ userInfo.follow_count }}</span>\r\n                    <span>关注</span>\r\n                </div>\r\n                <div class=\"user-data-item\">\r\n                    <span>{{userInfo.fans_count}}</span>\r\n                    <span>粉丝</span>\r\n                </div>\r\n                <div class=\"user-data-item\">\r\n                    <span>{{ userInfo.like_count}}</span>\r\n                    <span>很赞</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 自定义功能格 -->\r\n        <van-grid :column-num=\"2\" clickable>\r\n            <van-grid-item text=\"收藏\" class=\"grid-item\">\r\n                <template #icon>\r\n                    <i class=\"ranran icon-shoucang\"></i>\r\n                </template>\r\n            </van-grid-item>\r\n            <van-grid-item text=\"历史\" class=\"grid-item history\">\r\n                <template #icon>\r\n                    <i class=\"ranran icon-lishi\"></i>\r\n                </template>\r\n            </van-grid-item>\r\n        </van-grid>\r\n\r\n        <!-- 操作面板 -->\r\n        <van-cell-group class=\"action-card\">\r\n            <van-cell icon=\"edit\" title=\"编辑资料\" is-link />\r\n            <van-cell icon=\"chat-o\" title=\"小思同学\" is-link />\r\n        </van-cell-group>\r\n        <van-cell v-if=\"user\" @click=\"onLogout\" class=\"text3\" icon=\"warning-o\" title=\"退出登录\" is-link />\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from \"vuex\";\r\nimport { getUserinfo } from \"../../api/users\"\r\n\r\nexport default {\r\n    name: \"my-info\",\r\n    data(){\r\n        return {\r\n            userInfo:{}\r\n        }\r\n    },\r\n    computed: {\r\n        ...mapState([\"user\"]),\r\n    },\r\n    methods: {\r\n        onLogout() {\r\n            this.$dialog.confirm({\r\n                title: \"退出登录\",\r\n            }).then(() => {\r\n                    // on confirm\r\n                    this.$store.commit(\"setUser\",null)\r\n                })\r\n                .catch(() => {\r\n                    // on cancel\r\n                });\r\n        },\r\n        async loadUserInfo(){\r\n            try {\r\n                const { data } = await getUserinfo()\r\n                this.userInfo = data.data\r\n                console.log(this.userInfo);\r\n            }catch {\r\n                this.$toast(\"获取数据失败，未知错误\")\r\n            }\r\n        }\r\n        \r\n    },\r\n    created(){\r\n        if(this.user) this.loadUserInfo()\r\n    }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scope>\r\n.header {\r\n    height: 361px;\r\n    background: url(\"../../assets/banner.png\");\r\n    object-fit: scale-down;\r\n    object-position: center;\r\n}\r\n.avatar {\r\n    border: 4px solid white;\r\n}\r\n.text3 {\r\n  margin-top: 10px;\r\n  color: #eb5253;\r\n}\r\n.not-login {\r\n    justify-content: center;\r\n    align-items: center;\r\n    display: flex;\r\n    .login {\r\n        flex-direction: column;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        img {\r\n            width: 132px;\r\n            height: 132px;\r\n            margin-bottom: 15px;\r\n        }\r\n        .text {\r\n            font-size: 28px;\r\n            color: white;\r\n        }\r\n    }\r\n}\r\n.user-card {\r\n    background-color: #007bff;\r\n    color: white;\r\n    padding-top: 20px;\r\n    .van-cell {\r\n        background: #007bff;\r\n        color: white;\r\n        &::after {\r\n            display: none;\r\n        }\r\n        .avatar {\r\n            width: 60px;\r\n            height: 60px;\r\n            background-color: #fff;\r\n            border-radius: 50%;\r\n            margin-right: 10px;\r\n        }\r\n        .username {\r\n            font-size: 14px;\r\n            font-weight: bold;\r\n        }\r\n    }\r\n}\r\n.user-data {\r\n    display: flex;\r\n    justify-content: space-evenly;\r\n    align-items: center;\r\n    font-size: 14px;\r\n    padding: 30px 0;\r\n    .user-data-item {\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        align-items: center;\r\n        width: 33.33%;\r\n    }\r\n}\r\n.grid-item {\r\n    height: 141px;\r\n    i {\r\n        font-size: 45px;\r\n        color: #eb5253;\r\n    }\r\n    .van-grid-item__text {\r\n        font-size: 28px;\r\n    }\r\n}\r\n.history {\r\n    i {\r\n        color: #ff9d1d;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}