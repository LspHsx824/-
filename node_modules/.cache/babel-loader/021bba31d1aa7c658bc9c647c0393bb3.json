{"ast":null,"code":"import \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\"; // Utils\n\nimport { createNamespace } from '../utils';\nimport { preventDefault } from '../utils/dom/event';\nimport { BORDER_UNSET_TOP_BOTTOM } from '../utils/constant';\nimport { pickerProps, DEFAULT_ITEM_HEIGHT } from './shared';\nimport { unitToPx } from '../utils/format/unit'; // Components\n\nimport Loading from '../loading';\nimport PickerColumn from './PickerColumn';\n\nvar _createNamespace = createNamespace('picker'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1],\n    t = _createNamespace[2];\n\nexport default createComponent({\n  props: _extends({}, pickerProps, {\n    defaultIndex: {\n      type: [Number, String],\n      default: 0\n    },\n    columns: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    toolbarPosition: {\n      type: String,\n      default: 'top'\n    },\n    valueKey: {\n      type: String,\n      default: 'text'\n    }\n  }),\n  data: function data() {\n    return {\n      children: [],\n      formattedColumns: []\n    };\n  },\n  computed: {\n    itemPxHeight: function itemPxHeight() {\n      return this.itemHeight ? unitToPx(this.itemHeight) : DEFAULT_ITEM_HEIGHT;\n    },\n    dataType: function dataType() {\n      var columns = this.columns;\n      var firstColumn = columns[0] || {};\n\n      if (firstColumn.children) {\n        return 'cascade';\n      }\n\n      if (firstColumn.values) {\n        return 'object';\n      }\n\n      return 'text';\n    }\n  },\n  watch: {\n    columns: {\n      handler: 'format',\n      immediate: true\n    }\n  },\n  methods: {\n    format: function format() {\n      var columns = this.columns,\n          dataType = this.dataType;\n\n      if (dataType === 'text') {\n        this.formattedColumns = [{\n          values: columns\n        }];\n      } else if (dataType === 'cascade') {\n        this.formatCascade();\n      } else {\n        this.formattedColumns = columns;\n      }\n    },\n    formatCascade: function formatCascade() {\n      var formatted = [];\n      var cursor = {\n        children: this.columns\n      };\n\n      while (cursor && cursor.children) {\n        var _cursor$defaultIndex;\n\n        var _cursor = cursor,\n            children = _cursor.children;\n        var defaultIndex = (_cursor$defaultIndex = cursor.defaultIndex) != null ? _cursor$defaultIndex : +this.defaultIndex;\n\n        while (children[defaultIndex] && children[defaultIndex].disabled) {\n          if (defaultIndex < children.length - 1) {\n            defaultIndex++;\n          } else {\n            defaultIndex = 0;\n            break;\n          }\n        }\n\n        formatted.push({\n          values: cursor.children,\n          className: cursor.className,\n          defaultIndex: defaultIndex\n        });\n        cursor = children[defaultIndex];\n      }\n\n      this.formattedColumns = formatted;\n    },\n    emit: function emit(event) {\n      var _this = this;\n\n      if (this.dataType === 'text') {\n        this.$emit(event, this.getColumnValue(0), this.getColumnIndex(0));\n      } else {\n        var values = this.getValues(); // compatible with old version of wrong parameters\n        // should be removed in next major version\n        // see: https://github.com/youzan/vant/issues/5905\n\n        if (this.dataType === 'cascade') {\n          values = values.map(function (item) {\n            return item[_this.valueKey];\n          });\n        }\n\n        this.$emit(event, values, this.getIndexes());\n      }\n    },\n    onCascadeChange: function onCascadeChange(columnIndex) {\n      var cursor = {\n        children: this.columns\n      };\n      var indexes = this.getIndexes();\n\n      for (var i = 0; i <= columnIndex; i++) {\n        cursor = cursor.children[indexes[i]];\n      }\n\n      while (cursor && cursor.children) {\n        columnIndex++;\n        this.setColumnValues(columnIndex, cursor.children);\n        cursor = cursor.children[cursor.defaultIndex || 0];\n      }\n    },\n    onChange: function onChange(columnIndex) {\n      var _this2 = this;\n\n      if (this.dataType === 'cascade') {\n        this.onCascadeChange(columnIndex);\n      }\n\n      if (this.dataType === 'text') {\n        this.$emit('change', this, this.getColumnValue(0), this.getColumnIndex(0));\n      } else {\n        var values = this.getValues(); // compatible with old version of wrong parameters\n        // should be removed in next major version\n        // see: https://github.com/youzan/vant/issues/5905\n\n        if (this.dataType === 'cascade') {\n          values = values.map(function (item) {\n            return item[_this2.valueKey];\n          });\n        }\n\n        this.$emit('change', this, values, columnIndex);\n      }\n    },\n    // get column instance by index\n    getColumn: function getColumn(index) {\n      return this.children[index];\n    },\n    // @exposed-api\n    // get column value by index\n    getColumnValue: function getColumnValue(index) {\n      var column = this.getColumn(index);\n      return column && column.getValue();\n    },\n    // @exposed-api\n    // set column value by index\n    setColumnValue: function setColumnValue(index, value) {\n      var column = this.getColumn(index);\n\n      if (column) {\n        column.setValue(value);\n\n        if (this.dataType === 'cascade') {\n          this.onCascadeChange(index);\n        }\n      }\n    },\n    // @exposed-api\n    // get column option index by column index\n    getColumnIndex: function getColumnIndex(columnIndex) {\n      return (this.getColumn(columnIndex) || {}).currentIndex;\n    },\n    // @exposed-api\n    // set column option index by column index\n    setColumnIndex: function setColumnIndex(columnIndex, optionIndex) {\n      var column = this.getColumn(columnIndex);\n\n      if (column) {\n        column.setIndex(optionIndex);\n\n        if (this.dataType === 'cascade') {\n          this.onCascadeChange(columnIndex);\n        }\n      }\n    },\n    // @exposed-api\n    // get options of column by index\n    getColumnValues: function getColumnValues(index) {\n      return (this.children[index] || {}).options;\n    },\n    // @exposed-api\n    // set options of column by index\n    setColumnValues: function setColumnValues(index, options) {\n      var column = this.children[index];\n\n      if (column) {\n        column.setOptions(options);\n      }\n    },\n    // @exposed-api\n    // get values of all columns\n    getValues: function getValues() {\n      return this.children.map(function (child) {\n        return child.getValue();\n      });\n    },\n    // @exposed-api\n    // set values of all columns\n    setValues: function setValues(values) {\n      var _this3 = this;\n\n      values.forEach(function (value, index) {\n        _this3.setColumnValue(index, value);\n      });\n    },\n    // @exposed-api\n    // get indexes of all columns\n    getIndexes: function getIndexes() {\n      return this.children.map(function (child) {\n        return child.currentIndex;\n      });\n    },\n    // @exposed-api\n    // set indexes of all columns\n    setIndexes: function setIndexes(indexes) {\n      var _this4 = this;\n\n      indexes.forEach(function (optionIndex, columnIndex) {\n        _this4.setColumnIndex(columnIndex, optionIndex);\n      });\n    },\n    // @exposed-api\n    confirm: function confirm() {\n      this.children.forEach(function (child) {\n        return child.stopMomentum();\n      });\n      this.emit('confirm');\n    },\n    cancel: function cancel() {\n      this.emit('cancel');\n    },\n    genTitle: function genTitle() {\n      var h = this.$createElement;\n      var titleSlot = this.slots('title');\n\n      if (titleSlot) {\n        return titleSlot;\n      }\n\n      if (this.title) {\n        return h(\"div\", {\n          \"class\": ['van-ellipsis', bem('title')]\n        }, [this.title]);\n      }\n    },\n    genCancel: function genCancel() {\n      var h = this.$createElement;\n      return h(\"button\", {\n        \"attrs\": {\n          \"type\": \"button\"\n        },\n        \"class\": bem('cancel'),\n        \"on\": {\n          \"click\": this.cancel\n        }\n      }, [this.slots('cancel') || this.cancelButtonText || t('cancel')]);\n    },\n    genConfirm: function genConfirm() {\n      var h = this.$createElement;\n      return h(\"button\", {\n        \"attrs\": {\n          \"type\": \"button\"\n        },\n        \"class\": bem('confirm'),\n        \"on\": {\n          \"click\": this.confirm\n        }\n      }, [this.slots('confirm') || this.confirmButtonText || t('confirm')]);\n    },\n    genToolbar: function genToolbar() {\n      var h = this.$createElement;\n\n      if (this.showToolbar) {\n        return h(\"div\", {\n          \"class\": bem('toolbar')\n        }, [this.slots() || [this.genCancel(), this.genTitle(), this.genConfirm()]]);\n      }\n    },\n    genColumns: function genColumns() {\n      var h = this.$createElement;\n      var itemPxHeight = this.itemPxHeight;\n      var wrapHeight = itemPxHeight * this.visibleItemCount;\n      var frameStyle = {\n        height: itemPxHeight + \"px\"\n      };\n      var columnsStyle = {\n        height: wrapHeight + \"px\"\n      };\n      var maskStyle = {\n        backgroundSize: \"100% \" + (wrapHeight - itemPxHeight) / 2 + \"px\"\n      };\n      return h(\"div\", {\n        \"class\": bem('columns'),\n        \"style\": columnsStyle,\n        \"on\": {\n          \"touchmove\": preventDefault\n        }\n      }, [this.genColumnItems(), h(\"div\", {\n        \"class\": bem('mask'),\n        \"style\": maskStyle\n      }), h(\"div\", {\n        \"class\": [BORDER_UNSET_TOP_BOTTOM, bem('frame')],\n        \"style\": frameStyle\n      })]);\n    },\n    genColumnItems: function genColumnItems() {\n      var _this5 = this;\n\n      var h = this.$createElement;\n      return this.formattedColumns.map(function (item, columnIndex) {\n        var _item$defaultIndex;\n\n        return h(PickerColumn, {\n          \"attrs\": {\n            \"readonly\": _this5.readonly,\n            \"valueKey\": _this5.valueKey,\n            \"allowHtml\": _this5.allowHtml,\n            \"className\": item.className,\n            \"itemHeight\": _this5.itemPxHeight,\n            \"defaultIndex\": (_item$defaultIndex = item.defaultIndex) != null ? _item$defaultIndex : +_this5.defaultIndex,\n            \"swipeDuration\": _this5.swipeDuration,\n            \"visibleItemCount\": _this5.visibleItemCount,\n            \"initialOptions\": item.values\n          },\n          \"scopedSlots\": {\n            option: _this5.$scopedSlots.option\n          },\n          \"on\": {\n            \"change\": function change() {\n              _this5.onChange(columnIndex);\n            }\n          }\n        });\n      });\n    }\n  },\n  render: function render(h) {\n    return h(\"div\", {\n      \"class\": bem()\n    }, [this.toolbarPosition === 'top' ? this.genToolbar() : h(), this.loading ? h(Loading, {\n      \"class\": bem('loading')\n    }) : h(), this.slots('columns-top'), this.genColumns(), this.slots('columns-bottom'), this.toolbarPosition === 'bottom' ? this.genToolbar() : h()]);\n  }\n});","map":{"version":3,"sources":["C:/Users/Lisp/Desktop/Vue-app/items/node_modules/vant/es/picker/index.js"],"names":["_extends","createNamespace","preventDefault","BORDER_UNSET_TOP_BOTTOM","pickerProps","DEFAULT_ITEM_HEIGHT","unitToPx","Loading","PickerColumn","_createNamespace","createComponent","bem","t","props","defaultIndex","type","Number","String","default","columns","Array","_default","toolbarPosition","valueKey","data","children","formattedColumns","computed","itemPxHeight","itemHeight","dataType","firstColumn","values","watch","handler","immediate","methods","format","formatCascade","formatted","cursor","_cursor$defaultIndex","_cursor","disabled","length","push","className","emit","event","_this","$emit","getColumnValue","getColumnIndex","getValues","map","item","getIndexes","onCascadeChange","columnIndex","indexes","i","setColumnValues","onChange","_this2","getColumn","index","column","getValue","setColumnValue","value","setValue","currentIndex","setColumnIndex","optionIndex","setIndex","getColumnValues","options","setOptions","child","setValues","_this3","forEach","setIndexes","_this4","confirm","stopMomentum","cancel","genTitle","h","$createElement","titleSlot","slots","title","genCancel","cancelButtonText","genConfirm","confirmButtonText","genToolbar","showToolbar","genColumns","wrapHeight","visibleItemCount","frameStyle","height","columnsStyle","maskStyle","backgroundSize","genColumnItems","_this5","_item$defaultIndex","readonly","allowHtml","swipeDuration","option","$scopedSlots","change","render","loading"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\n// Utils\nimport { createNamespace } from '../utils';\nimport { preventDefault } from '../utils/dom/event';\nimport { BORDER_UNSET_TOP_BOTTOM } from '../utils/constant';\nimport { pickerProps, DEFAULT_ITEM_HEIGHT } from './shared';\nimport { unitToPx } from '../utils/format/unit'; // Components\n\nimport Loading from '../loading';\nimport PickerColumn from './PickerColumn';\n\nvar _createNamespace = createNamespace('picker'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1],\n    t = _createNamespace[2];\n\nexport default createComponent({\n  props: _extends({}, pickerProps, {\n    defaultIndex: {\n      type: [Number, String],\n      default: 0\n    },\n    columns: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    toolbarPosition: {\n      type: String,\n      default: 'top'\n    },\n    valueKey: {\n      type: String,\n      default: 'text'\n    }\n  }),\n  data: function data() {\n    return {\n      children: [],\n      formattedColumns: []\n    };\n  },\n  computed: {\n    itemPxHeight: function itemPxHeight() {\n      return this.itemHeight ? unitToPx(this.itemHeight) : DEFAULT_ITEM_HEIGHT;\n    },\n    dataType: function dataType() {\n      var columns = this.columns;\n      var firstColumn = columns[0] || {};\n\n      if (firstColumn.children) {\n        return 'cascade';\n      }\n\n      if (firstColumn.values) {\n        return 'object';\n      }\n\n      return 'text';\n    }\n  },\n  watch: {\n    columns: {\n      handler: 'format',\n      immediate: true\n    }\n  },\n  methods: {\n    format: function format() {\n      var columns = this.columns,\n          dataType = this.dataType;\n\n      if (dataType === 'text') {\n        this.formattedColumns = [{\n          values: columns\n        }];\n      } else if (dataType === 'cascade') {\n        this.formatCascade();\n      } else {\n        this.formattedColumns = columns;\n      }\n    },\n    formatCascade: function formatCascade() {\n      var formatted = [];\n      var cursor = {\n        children: this.columns\n      };\n\n      while (cursor && cursor.children) {\n        var _cursor$defaultIndex;\n\n        var _cursor = cursor,\n            children = _cursor.children;\n        var defaultIndex = (_cursor$defaultIndex = cursor.defaultIndex) != null ? _cursor$defaultIndex : +this.defaultIndex;\n\n        while (children[defaultIndex] && children[defaultIndex].disabled) {\n          if (defaultIndex < children.length - 1) {\n            defaultIndex++;\n          } else {\n            defaultIndex = 0;\n            break;\n          }\n        }\n\n        formatted.push({\n          values: cursor.children,\n          className: cursor.className,\n          defaultIndex: defaultIndex\n        });\n        cursor = children[defaultIndex];\n      }\n\n      this.formattedColumns = formatted;\n    },\n    emit: function emit(event) {\n      var _this = this;\n\n      if (this.dataType === 'text') {\n        this.$emit(event, this.getColumnValue(0), this.getColumnIndex(0));\n      } else {\n        var values = this.getValues(); // compatible with old version of wrong parameters\n        // should be removed in next major version\n        // see: https://github.com/youzan/vant/issues/5905\n\n        if (this.dataType === 'cascade') {\n          values = values.map(function (item) {\n            return item[_this.valueKey];\n          });\n        }\n\n        this.$emit(event, values, this.getIndexes());\n      }\n    },\n    onCascadeChange: function onCascadeChange(columnIndex) {\n      var cursor = {\n        children: this.columns\n      };\n      var indexes = this.getIndexes();\n\n      for (var i = 0; i <= columnIndex; i++) {\n        cursor = cursor.children[indexes[i]];\n      }\n\n      while (cursor && cursor.children) {\n        columnIndex++;\n        this.setColumnValues(columnIndex, cursor.children);\n        cursor = cursor.children[cursor.defaultIndex || 0];\n      }\n    },\n    onChange: function onChange(columnIndex) {\n      var _this2 = this;\n\n      if (this.dataType === 'cascade') {\n        this.onCascadeChange(columnIndex);\n      }\n\n      if (this.dataType === 'text') {\n        this.$emit('change', this, this.getColumnValue(0), this.getColumnIndex(0));\n      } else {\n        var values = this.getValues(); // compatible with old version of wrong parameters\n        // should be removed in next major version\n        // see: https://github.com/youzan/vant/issues/5905\n\n        if (this.dataType === 'cascade') {\n          values = values.map(function (item) {\n            return item[_this2.valueKey];\n          });\n        }\n\n        this.$emit('change', this, values, columnIndex);\n      }\n    },\n    // get column instance by index\n    getColumn: function getColumn(index) {\n      return this.children[index];\n    },\n    // @exposed-api\n    // get column value by index\n    getColumnValue: function getColumnValue(index) {\n      var column = this.getColumn(index);\n      return column && column.getValue();\n    },\n    // @exposed-api\n    // set column value by index\n    setColumnValue: function setColumnValue(index, value) {\n      var column = this.getColumn(index);\n\n      if (column) {\n        column.setValue(value);\n\n        if (this.dataType === 'cascade') {\n          this.onCascadeChange(index);\n        }\n      }\n    },\n    // @exposed-api\n    // get column option index by column index\n    getColumnIndex: function getColumnIndex(columnIndex) {\n      return (this.getColumn(columnIndex) || {}).currentIndex;\n    },\n    // @exposed-api\n    // set column option index by column index\n    setColumnIndex: function setColumnIndex(columnIndex, optionIndex) {\n      var column = this.getColumn(columnIndex);\n\n      if (column) {\n        column.setIndex(optionIndex);\n\n        if (this.dataType === 'cascade') {\n          this.onCascadeChange(columnIndex);\n        }\n      }\n    },\n    // @exposed-api\n    // get options of column by index\n    getColumnValues: function getColumnValues(index) {\n      return (this.children[index] || {}).options;\n    },\n    // @exposed-api\n    // set options of column by index\n    setColumnValues: function setColumnValues(index, options) {\n      var column = this.children[index];\n\n      if (column) {\n        column.setOptions(options);\n      }\n    },\n    // @exposed-api\n    // get values of all columns\n    getValues: function getValues() {\n      return this.children.map(function (child) {\n        return child.getValue();\n      });\n    },\n    // @exposed-api\n    // set values of all columns\n    setValues: function setValues(values) {\n      var _this3 = this;\n\n      values.forEach(function (value, index) {\n        _this3.setColumnValue(index, value);\n      });\n    },\n    // @exposed-api\n    // get indexes of all columns\n    getIndexes: function getIndexes() {\n      return this.children.map(function (child) {\n        return child.currentIndex;\n      });\n    },\n    // @exposed-api\n    // set indexes of all columns\n    setIndexes: function setIndexes(indexes) {\n      var _this4 = this;\n\n      indexes.forEach(function (optionIndex, columnIndex) {\n        _this4.setColumnIndex(columnIndex, optionIndex);\n      });\n    },\n    // @exposed-api\n    confirm: function confirm() {\n      this.children.forEach(function (child) {\n        return child.stopMomentum();\n      });\n      this.emit('confirm');\n    },\n    cancel: function cancel() {\n      this.emit('cancel');\n    },\n    genTitle: function genTitle() {\n      var h = this.$createElement;\n      var titleSlot = this.slots('title');\n\n      if (titleSlot) {\n        return titleSlot;\n      }\n\n      if (this.title) {\n        return h(\"div\", {\n          \"class\": ['van-ellipsis', bem('title')]\n        }, [this.title]);\n      }\n    },\n    genCancel: function genCancel() {\n      var h = this.$createElement;\n      return h(\"button\", {\n        \"attrs\": {\n          \"type\": \"button\"\n        },\n        \"class\": bem('cancel'),\n        \"on\": {\n          \"click\": this.cancel\n        }\n      }, [this.slots('cancel') || this.cancelButtonText || t('cancel')]);\n    },\n    genConfirm: function genConfirm() {\n      var h = this.$createElement;\n      return h(\"button\", {\n        \"attrs\": {\n          \"type\": \"button\"\n        },\n        \"class\": bem('confirm'),\n        \"on\": {\n          \"click\": this.confirm\n        }\n      }, [this.slots('confirm') || this.confirmButtonText || t('confirm')]);\n    },\n    genToolbar: function genToolbar() {\n      var h = this.$createElement;\n\n      if (this.showToolbar) {\n        return h(\"div\", {\n          \"class\": bem('toolbar')\n        }, [this.slots() || [this.genCancel(), this.genTitle(), this.genConfirm()]]);\n      }\n    },\n    genColumns: function genColumns() {\n      var h = this.$createElement;\n      var itemPxHeight = this.itemPxHeight;\n      var wrapHeight = itemPxHeight * this.visibleItemCount;\n      var frameStyle = {\n        height: itemPxHeight + \"px\"\n      };\n      var columnsStyle = {\n        height: wrapHeight + \"px\"\n      };\n      var maskStyle = {\n        backgroundSize: \"100% \" + (wrapHeight - itemPxHeight) / 2 + \"px\"\n      };\n      return h(\"div\", {\n        \"class\": bem('columns'),\n        \"style\": columnsStyle,\n        \"on\": {\n          \"touchmove\": preventDefault\n        }\n      }, [this.genColumnItems(), h(\"div\", {\n        \"class\": bem('mask'),\n        \"style\": maskStyle\n      }), h(\"div\", {\n        \"class\": [BORDER_UNSET_TOP_BOTTOM, bem('frame')],\n        \"style\": frameStyle\n      })]);\n    },\n    genColumnItems: function genColumnItems() {\n      var _this5 = this;\n\n      var h = this.$createElement;\n      return this.formattedColumns.map(function (item, columnIndex) {\n        var _item$defaultIndex;\n\n        return h(PickerColumn, {\n          \"attrs\": {\n            \"readonly\": _this5.readonly,\n            \"valueKey\": _this5.valueKey,\n            \"allowHtml\": _this5.allowHtml,\n            \"className\": item.className,\n            \"itemHeight\": _this5.itemPxHeight,\n            \"defaultIndex\": (_item$defaultIndex = item.defaultIndex) != null ? _item$defaultIndex : +_this5.defaultIndex,\n            \"swipeDuration\": _this5.swipeDuration,\n            \"visibleItemCount\": _this5.visibleItemCount,\n            \"initialOptions\": item.values\n          },\n          \"scopedSlots\": {\n            option: _this5.$scopedSlots.option\n          },\n          \"on\": {\n            \"change\": function change() {\n              _this5.onChange(columnIndex);\n            }\n          }\n        });\n      });\n    }\n  },\n  render: function render(h) {\n    return h(\"div\", {\n      \"class\": bem()\n    }, [this.toolbarPosition === 'top' ? this.genToolbar() : h(), this.loading ? h(Loading, {\n      \"class\": bem('loading')\n    }) : h(), this.slots('columns-top'), this.genColumns(), this.slots('columns-bottom'), this.toolbarPosition === 'bottom' ? this.genToolbar() : h()]);\n  }\n});"]},"metadata":{},"sourceType":"module"}