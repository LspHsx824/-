{"ast":null,"code":"import \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.string.replace.js\";\n// Utils\nimport { createNamespace } from '../../utils';\nimport { isEmail } from '../../utils/validate/email';\nimport { isNumeric } from '../../utils/validate/number'; // Components\n\nimport Cell from '../../cell';\nimport Field from '../../field';\nimport SkuImgUploader from './SkuImgUploader';\nimport SkuDateTimeField from './SkuDateTimeField';\n\nvar _createNamespace = createNamespace('sku-messages'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1],\n    t = _createNamespace[2];\n\nexport default createComponent({\n  props: {\n    messageConfig: Object,\n    goodsId: [Number, String],\n    messages: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    }\n  },\n  data: function data() {\n    return {\n      messageValues: this.resetMessageValues(this.messages)\n    };\n  },\n  watch: {\n    messages: function messages(val) {\n      this.messageValues = this.resetMessageValues(val);\n    }\n  },\n  methods: {\n    resetMessageValues: function resetMessageValues(messages) {\n      var messageConfig = this.messageConfig;\n      var _messageConfig$initia = messageConfig.initialMessages,\n          initialMessages = _messageConfig$initia === void 0 ? {} : _messageConfig$initia;\n      return (messages || []).map(function (message) {\n        return {\n          value: initialMessages[message.name] || ''\n        };\n      });\n    },\n    getType: function getType(message) {\n      if (+message.multiple === 1) {\n        return 'textarea';\n      }\n\n      if (message.type === 'id_no') {\n        return 'text';\n      }\n\n      return message.datetime > 0 ? 'datetime' : message.type;\n    },\n    getMessages: function getMessages() {\n      var messages = {};\n      this.messageValues.forEach(function (item, index) {\n        messages[\"message_\" + index] = item.value;\n      });\n      return messages;\n    },\n    getCartMessages: function getCartMessages() {\n      var _this = this;\n\n      var messages = {};\n      this.messageValues.forEach(function (item, index) {\n        var message = _this.messages[index];\n        messages[message.name] = item.value;\n      });\n      return messages;\n    },\n    getPlaceholder: function getPlaceholder(message) {\n      var type = +message.multiple === 1 ? 'textarea' : message.type;\n      var map = this.messageConfig.placeholderMap || {};\n      return message.placeholder || map[type] || t(\"placeholder.\" + type);\n    },\n    validateMessages: function validateMessages() {\n      var values = this.messageValues;\n\n      for (var i = 0; i < values.length; i++) {\n        var value = values[i].value;\n        var message = this.messages[i];\n\n        if (value === '') {\n          // 必填字段的校验\n          if (String(message.required) === '1') {\n            var textType = t(message.type === 'image' ? 'upload' : 'fill');\n            return textType + message.name;\n          }\n        } else {\n          if (message.type === 'tel' && !isNumeric(value)) {\n            return t('invalid.tel');\n          }\n\n          if (message.type === 'mobile' && !/^\\d{6,20}$/.test(value)) {\n            return t('invalid.mobile');\n          }\n\n          if (message.type === 'email' && !isEmail(value)) {\n            return t('invalid.email');\n          }\n\n          if (message.type === 'id_no' && (value.length < 15 || value.length > 18)) {\n            return t('invalid.id_no');\n          }\n        }\n      }\n    },\n\n    /**\n     * The phone number copied from IOS mobile phone address book\n     * will add spaces and invisible Unicode characters\n     * which cannot pass the /^\\d+$/ verification\n     * so keep numbers and dots\n     */\n    getFormatter: function getFormatter(message) {\n      return function formatter(value) {\n        if (message.type === 'mobile' || message.type === 'tel') {\n          return value.replace(/[^\\d.]/g, '');\n        }\n\n        return value;\n      };\n    },\n    getExtraDesc: function getExtraDesc(message) {\n      var h = this.$createElement;\n      var extraDesc = message.extraDesc;\n\n      if (extraDesc) {\n        return h(\"div\", {\n          \"class\": bem('extra-message')\n        }, [extraDesc]);\n      }\n    },\n    genMessage: function genMessage(message, index) {\n      var _this2 = this;\n\n      var h = this.$createElement;\n\n      if (message.type === 'image') {\n        return h(Cell, {\n          \"key\": this.goodsId + \"-\" + index,\n          \"attrs\": {\n            \"title\": message.name,\n            \"required\": String(message.required) === '1',\n            \"valueClass\": bem('image-cell-value')\n          },\n          \"class\": bem('image-cell')\n        }, [h(SkuImgUploader, {\n          \"attrs\": {\n            \"maxSize\": this.messageConfig.uploadMaxSize,\n            \"uploadImg\": this.messageConfig.uploadImg,\n            \"customUpload\": this.messageConfig.customUpload\n          },\n          \"model\": {\n            value: _this2.messageValues[index].value,\n            callback: function callback($$v) {\n              _this2.$set(_this2.messageValues[index], \"value\", $$v);\n            }\n          }\n        }), h(\"div\", {\n          \"class\": bem('image-cell-label')\n        }, [t('imageLabel')])]);\n      } // 时间和日期使用的vant选择器\n\n\n      var isDateOrTime = ['date', 'time'].indexOf(message.type) > -1;\n\n      if (isDateOrTime) {\n        return h(SkuDateTimeField, {\n          \"attrs\": {\n            \"label\": message.name,\n            \"required\": String(message.required) === '1',\n            \"placeholder\": this.getPlaceholder(message),\n            \"type\": this.getType(message)\n          },\n          \"key\": this.goodsId + \"-\" + index,\n          \"model\": {\n            value: _this2.messageValues[index].value,\n            callback: function callback($$v) {\n              _this2.$set(_this2.messageValues[index], \"value\", $$v);\n            }\n          }\n        });\n      }\n\n      return h(\"div\", {\n        \"class\": bem('cell-block')\n      }, [h(Field, {\n        \"attrs\": {\n          \"maxlength\": \"200\",\n          \"center\": !message.multiple,\n          \"label\": message.name,\n          \"required\": String(message.required) === '1',\n          \"placeholder\": this.getPlaceholder(message),\n          \"type\": this.getType(message),\n          \"formatter\": this.getFormatter(message),\n          \"border\": false\n        },\n        \"key\": this.goodsId + \"-\" + index,\n        \"model\": {\n          value: _this2.messageValues[index].value,\n          callback: function callback($$v) {\n            _this2.$set(_this2.messageValues[index], \"value\", $$v);\n          }\n        }\n      }), this.getExtraDesc(message)]);\n    }\n  },\n  render: function render() {\n    var h = arguments[0];\n    return h(\"div\", {\n      \"class\": bem()\n    }, [this.messages.map(this.genMessage)]);\n  }\n});","map":{"version":3,"sources":["C:/Users/Lisp/Desktop/items/node_modules/vant/es/sku/components/SkuMessages.js"],"names":["createNamespace","isEmail","isNumeric","Cell","Field","SkuImgUploader","SkuDateTimeField","_createNamespace","createComponent","bem","t","props","messageConfig","Object","goodsId","Number","String","messages","type","Array","default","_default","data","messageValues","resetMessageValues","watch","val","methods","_messageConfig$initia","initialMessages","map","message","value","name","getType","multiple","datetime","getMessages","forEach","item","index","getCartMessages","_this","getPlaceholder","placeholderMap","placeholder","validateMessages","values","i","length","required","textType","test","getFormatter","formatter","replace","getExtraDesc","h","$createElement","extraDesc","genMessage","_this2","uploadMaxSize","uploadImg","customUpload","callback","$$v","$set","isDateOrTime","indexOf","render","arguments"],"mappings":"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","sourcesContent":["// Utils\nimport { createNamespace } from '../../utils';\nimport { isEmail } from '../../utils/validate/email';\nimport { isNumeric } from '../../utils/validate/number'; // Components\n\nimport Cell from '../../cell';\nimport Field from '../../field';\nimport SkuImgUploader from './SkuImgUploader';\nimport SkuDateTimeField from './SkuDateTimeField';\n\nvar _createNamespace = createNamespace('sku-messages'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1],\n    t = _createNamespace[2];\n\nexport default createComponent({\n  props: {\n    messageConfig: Object,\n    goodsId: [Number, String],\n    messages: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    }\n  },\n  data: function data() {\n    return {\n      messageValues: this.resetMessageValues(this.messages)\n    };\n  },\n  watch: {\n    messages: function messages(val) {\n      this.messageValues = this.resetMessageValues(val);\n    }\n  },\n  methods: {\n    resetMessageValues: function resetMessageValues(messages) {\n      var messageConfig = this.messageConfig;\n      var _messageConfig$initia = messageConfig.initialMessages,\n          initialMessages = _messageConfig$initia === void 0 ? {} : _messageConfig$initia;\n      return (messages || []).map(function (message) {\n        return {\n          value: initialMessages[message.name] || ''\n        };\n      });\n    },\n    getType: function getType(message) {\n      if (+message.multiple === 1) {\n        return 'textarea';\n      }\n\n      if (message.type === 'id_no') {\n        return 'text';\n      }\n\n      return message.datetime > 0 ? 'datetime' : message.type;\n    },\n    getMessages: function getMessages() {\n      var messages = {};\n      this.messageValues.forEach(function (item, index) {\n        messages[\"message_\" + index] = item.value;\n      });\n      return messages;\n    },\n    getCartMessages: function getCartMessages() {\n      var _this = this;\n\n      var messages = {};\n      this.messageValues.forEach(function (item, index) {\n        var message = _this.messages[index];\n        messages[message.name] = item.value;\n      });\n      return messages;\n    },\n    getPlaceholder: function getPlaceholder(message) {\n      var type = +message.multiple === 1 ? 'textarea' : message.type;\n      var map = this.messageConfig.placeholderMap || {};\n      return message.placeholder || map[type] || t(\"placeholder.\" + type);\n    },\n    validateMessages: function validateMessages() {\n      var values = this.messageValues;\n\n      for (var i = 0; i < values.length; i++) {\n        var value = values[i].value;\n        var message = this.messages[i];\n\n        if (value === '') {\n          // 必填字段的校验\n          if (String(message.required) === '1') {\n            var textType = t(message.type === 'image' ? 'upload' : 'fill');\n            return textType + message.name;\n          }\n        } else {\n          if (message.type === 'tel' && !isNumeric(value)) {\n            return t('invalid.tel');\n          }\n\n          if (message.type === 'mobile' && !/^\\d{6,20}$/.test(value)) {\n            return t('invalid.mobile');\n          }\n\n          if (message.type === 'email' && !isEmail(value)) {\n            return t('invalid.email');\n          }\n\n          if (message.type === 'id_no' && (value.length < 15 || value.length > 18)) {\n            return t('invalid.id_no');\n          }\n        }\n      }\n    },\n\n    /**\n     * The phone number copied from IOS mobile phone address book\n     * will add spaces and invisible Unicode characters\n     * which cannot pass the /^\\d+$/ verification\n     * so keep numbers and dots\n     */\n    getFormatter: function getFormatter(message) {\n      return function formatter(value) {\n        if (message.type === 'mobile' || message.type === 'tel') {\n          return value.replace(/[^\\d.]/g, '');\n        }\n\n        return value;\n      };\n    },\n    getExtraDesc: function getExtraDesc(message) {\n      var h = this.$createElement;\n      var extraDesc = message.extraDesc;\n\n      if (extraDesc) {\n        return h(\"div\", {\n          \"class\": bem('extra-message')\n        }, [extraDesc]);\n      }\n    },\n    genMessage: function genMessage(message, index) {\n      var _this2 = this;\n\n      var h = this.$createElement;\n\n      if (message.type === 'image') {\n        return h(Cell, {\n          \"key\": this.goodsId + \"-\" + index,\n          \"attrs\": {\n            \"title\": message.name,\n            \"required\": String(message.required) === '1',\n            \"valueClass\": bem('image-cell-value')\n          },\n          \"class\": bem('image-cell')\n        }, [h(SkuImgUploader, {\n          \"attrs\": {\n            \"maxSize\": this.messageConfig.uploadMaxSize,\n            \"uploadImg\": this.messageConfig.uploadImg,\n            \"customUpload\": this.messageConfig.customUpload\n          },\n          \"model\": {\n            value: _this2.messageValues[index].value,\n            callback: function callback($$v) {\n              _this2.$set(_this2.messageValues[index], \"value\", $$v);\n            }\n          }\n        }), h(\"div\", {\n          \"class\": bem('image-cell-label')\n        }, [t('imageLabel')])]);\n      } // 时间和日期使用的vant选择器\n\n\n      var isDateOrTime = ['date', 'time'].indexOf(message.type) > -1;\n\n      if (isDateOrTime) {\n        return h(SkuDateTimeField, {\n          \"attrs\": {\n            \"label\": message.name,\n            \"required\": String(message.required) === '1',\n            \"placeholder\": this.getPlaceholder(message),\n            \"type\": this.getType(message)\n          },\n          \"key\": this.goodsId + \"-\" + index,\n          \"model\": {\n            value: _this2.messageValues[index].value,\n            callback: function callback($$v) {\n              _this2.$set(_this2.messageValues[index], \"value\", $$v);\n            }\n          }\n        });\n      }\n\n      return h(\"div\", {\n        \"class\": bem('cell-block')\n      }, [h(Field, {\n        \"attrs\": {\n          \"maxlength\": \"200\",\n          \"center\": !message.multiple,\n          \"label\": message.name,\n          \"required\": String(message.required) === '1',\n          \"placeholder\": this.getPlaceholder(message),\n          \"type\": this.getType(message),\n          \"formatter\": this.getFormatter(message),\n          \"border\": false\n        },\n        \"key\": this.goodsId + \"-\" + index,\n        \"model\": {\n          value: _this2.messageValues[index].value,\n          callback: function callback($$v) {\n            _this2.$set(_this2.messageValues[index], \"value\", $$v);\n          }\n        }\n      }), this.getExtraDesc(message)]);\n    }\n  },\n  render: function render() {\n    var h = arguments[0];\n    return h(\"div\", {\n      \"class\": bem()\n    }, [this.messages.map(this.genMessage)]);\n  }\n});"]},"metadata":{},"sourceType":"module"}