{"ast":null,"code":"import \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport { createNamespace } from '../../utils';\nimport { LIMIT_TYPE } from '../constants';\nimport Stepper from '../../stepper';\nvar namespace = createNamespace('sku-stepper');\nvar createComponent = namespace[0];\nvar t = namespace[2];\nvar QUOTA_LIMIT = LIMIT_TYPE.QUOTA_LIMIT,\n    STOCK_LIMIT = LIMIT_TYPE.STOCK_LIMIT;\nexport default createComponent({\n  props: {\n    stock: Number,\n    skuEventBus: Object,\n    skuStockNum: Number,\n    selectedNum: Number,\n    stepperTitle: String,\n    disableStepperInput: Boolean,\n    customStepperConfig: Object,\n    hideQuotaText: Boolean,\n    quota: {\n      type: Number,\n      default: 0\n    },\n    quotaUsed: {\n      type: Number,\n      default: 0\n    },\n    startSaleNum: {\n      type: Number,\n      default: 1\n    }\n  },\n  data: function data() {\n    return {\n      currentNum: this.selectedNum,\n      // 购买限制类型: 限购/库存\n      limitType: STOCK_LIMIT\n    };\n  },\n  watch: {\n    currentNum: function currentNum(num) {\n      var intValue = parseInt(num, 10);\n\n      if (intValue >= this.stepperMinLimit && intValue <= this.stepperLimit) {\n        this.skuEventBus.$emit('sku:numChange', intValue);\n      }\n    },\n    stepperLimit: function stepperLimit(limit) {\n      if (limit < this.currentNum && this.stepperMinLimit <= limit) {\n        this.currentNum = limit;\n      }\n\n      this.checkState(this.stepperMinLimit, limit);\n    },\n    stepperMinLimit: function stepperMinLimit(start) {\n      if (start > this.currentNum || start > this.stepperLimit) {\n        this.currentNum = start;\n      }\n\n      this.checkState(start, this.stepperLimit);\n    }\n  },\n  computed: {\n    stepperLimit: function stepperLimit() {\n      var quotaLimit = this.quota - this.quotaUsed;\n      var limit; // 无限购时直接取库存，有限购时取限购数和库存数中小的那个\n\n      if (this.quota > 0 && quotaLimit <= this.stock) {\n        // 修正负的limit\n        limit = quotaLimit < 0 ? 0 : quotaLimit;\n        this.limitType = QUOTA_LIMIT;\n      } else {\n        limit = this.stock;\n        this.limitType = STOCK_LIMIT;\n      }\n\n      return limit;\n    },\n    stepperMinLimit: function stepperMinLimit() {\n      return this.startSaleNum < 1 ? 1 : this.startSaleNum;\n    },\n    quotaText: function quotaText() {\n      var _this$customStepperCo = this.customStepperConfig,\n          quotaText = _this$customStepperCo.quotaText,\n          hideQuotaText = _this$customStepperCo.hideQuotaText;\n      if (hideQuotaText) return '';\n      var text = '';\n\n      if (quotaText) {\n        text = quotaText;\n      } else {\n        var textArr = [];\n\n        if (this.startSaleNum > 1) {\n          textArr.push(t('quotaStart', this.startSaleNum));\n        }\n\n        if (this.quota > 0) {\n          textArr.push(t('quotaLimit', this.quota));\n        }\n\n        text = textArr.join(t('comma'));\n      }\n\n      return text;\n    }\n  },\n  created: function created() {\n    this.checkState(this.stepperMinLimit, this.stepperLimit);\n  },\n  methods: {\n    setCurrentNum: function setCurrentNum(num) {\n      this.currentNum = num;\n      this.checkState(this.stepperMinLimit, this.stepperLimit);\n    },\n    onOverLimit: function onOverLimit(action) {\n      this.skuEventBus.$emit('sku:overLimit', {\n        action: action,\n        limitType: this.limitType,\n        quota: this.quota,\n        quotaUsed: this.quotaUsed,\n        startSaleNum: this.startSaleNum\n      });\n    },\n    onChange: function onChange(currentValue) {\n      var intValue = parseInt(currentValue, 10);\n      var handleStepperChange = this.customStepperConfig.handleStepperChange;\n      handleStepperChange && handleStepperChange(intValue);\n      this.$emit('change', intValue);\n    },\n    checkState: function checkState(min, max) {\n      // 如果选择小于起售，则强制变为起售\n      if (this.currentNum < min || min > max) {\n        this.currentNum = min;\n      } else if (this.currentNum > max) {\n        // 当前选择数量大于最大可选时，需要重置已选数量\n        this.currentNum = max;\n      }\n\n      this.skuEventBus.$emit('sku:stepperState', {\n        valid: min <= max,\n        min: min,\n        max: max,\n        limitType: this.limitType,\n        quota: this.quota,\n        quotaUsed: this.quotaUsed,\n        startSaleNum: this.startSaleNum\n      });\n    }\n  },\n  render: function render() {\n    var _this = this;\n\n    var h = arguments[0];\n    return h(\"div\", {\n      \"class\": \"van-sku-stepper-stock\"\n    }, [h(\"div\", {\n      \"class\": \"van-sku__stepper-title\"\n    }, [this.stepperTitle || t('num')]), h(Stepper, {\n      \"attrs\": {\n        \"integer\": true,\n        \"min\": this.stepperMinLimit,\n        \"max\": this.stepperLimit,\n        \"disableInput\": this.disableStepperInput\n      },\n      \"class\": \"van-sku__stepper\",\n      \"on\": {\n        \"overlimit\": this.onOverLimit,\n        \"change\": this.onChange\n      },\n      \"model\": {\n        value: _this.currentNum,\n        callback: function callback($$v) {\n          _this.currentNum = $$v;\n        }\n      }\n    }), !this.hideQuotaText && this.quotaText && h(\"span\", {\n      \"class\": \"van-sku__stepper-quota\"\n    }, [\"(\", this.quotaText, \")\"])]);\n  }\n});","map":{"version":3,"sources":["C:/Users/Lisp/Desktop/Vue-app/items/node_modules/vant/es/sku/components/SkuStepper.js"],"names":["createNamespace","LIMIT_TYPE","Stepper","namespace","createComponent","t","QUOTA_LIMIT","STOCK_LIMIT","props","stock","Number","skuEventBus","Object","skuStockNum","selectedNum","stepperTitle","String","disableStepperInput","Boolean","customStepperConfig","hideQuotaText","quota","type","default","quotaUsed","startSaleNum","data","currentNum","limitType","watch","num","intValue","parseInt","stepperMinLimit","stepperLimit","$emit","limit","checkState","start","computed","quotaLimit","quotaText","_this$customStepperCo","text","textArr","push","join","created","methods","setCurrentNum","onOverLimit","action","onChange","currentValue","handleStepperChange","min","max","valid","render","_this","h","arguments","value","callback","$$v"],"mappings":"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","sourcesContent":["import { createNamespace } from '../../utils';\nimport { LIMIT_TYPE } from '../constants';\nimport Stepper from '../../stepper';\nvar namespace = createNamespace('sku-stepper');\nvar createComponent = namespace[0];\nvar t = namespace[2];\nvar QUOTA_LIMIT = LIMIT_TYPE.QUOTA_LIMIT,\n    STOCK_LIMIT = LIMIT_TYPE.STOCK_LIMIT;\nexport default createComponent({\n  props: {\n    stock: Number,\n    skuEventBus: Object,\n    skuStockNum: Number,\n    selectedNum: Number,\n    stepperTitle: String,\n    disableStepperInput: Boolean,\n    customStepperConfig: Object,\n    hideQuotaText: Boolean,\n    quota: {\n      type: Number,\n      default: 0\n    },\n    quotaUsed: {\n      type: Number,\n      default: 0\n    },\n    startSaleNum: {\n      type: Number,\n      default: 1\n    }\n  },\n  data: function data() {\n    return {\n      currentNum: this.selectedNum,\n      // 购买限制类型: 限购/库存\n      limitType: STOCK_LIMIT\n    };\n  },\n  watch: {\n    currentNum: function currentNum(num) {\n      var intValue = parseInt(num, 10);\n\n      if (intValue >= this.stepperMinLimit && intValue <= this.stepperLimit) {\n        this.skuEventBus.$emit('sku:numChange', intValue);\n      }\n    },\n    stepperLimit: function stepperLimit(limit) {\n      if (limit < this.currentNum && this.stepperMinLimit <= limit) {\n        this.currentNum = limit;\n      }\n\n      this.checkState(this.stepperMinLimit, limit);\n    },\n    stepperMinLimit: function stepperMinLimit(start) {\n      if (start > this.currentNum || start > this.stepperLimit) {\n        this.currentNum = start;\n      }\n\n      this.checkState(start, this.stepperLimit);\n    }\n  },\n  computed: {\n    stepperLimit: function stepperLimit() {\n      var quotaLimit = this.quota - this.quotaUsed;\n      var limit; // 无限购时直接取库存，有限购时取限购数和库存数中小的那个\n\n      if (this.quota > 0 && quotaLimit <= this.stock) {\n        // 修正负的limit\n        limit = quotaLimit < 0 ? 0 : quotaLimit;\n        this.limitType = QUOTA_LIMIT;\n      } else {\n        limit = this.stock;\n        this.limitType = STOCK_LIMIT;\n      }\n\n      return limit;\n    },\n    stepperMinLimit: function stepperMinLimit() {\n      return this.startSaleNum < 1 ? 1 : this.startSaleNum;\n    },\n    quotaText: function quotaText() {\n      var _this$customStepperCo = this.customStepperConfig,\n          quotaText = _this$customStepperCo.quotaText,\n          hideQuotaText = _this$customStepperCo.hideQuotaText;\n      if (hideQuotaText) return '';\n      var text = '';\n\n      if (quotaText) {\n        text = quotaText;\n      } else {\n        var textArr = [];\n\n        if (this.startSaleNum > 1) {\n          textArr.push(t('quotaStart', this.startSaleNum));\n        }\n\n        if (this.quota > 0) {\n          textArr.push(t('quotaLimit', this.quota));\n        }\n\n        text = textArr.join(t('comma'));\n      }\n\n      return text;\n    }\n  },\n  created: function created() {\n    this.checkState(this.stepperMinLimit, this.stepperLimit);\n  },\n  methods: {\n    setCurrentNum: function setCurrentNum(num) {\n      this.currentNum = num;\n      this.checkState(this.stepperMinLimit, this.stepperLimit);\n    },\n    onOverLimit: function onOverLimit(action) {\n      this.skuEventBus.$emit('sku:overLimit', {\n        action: action,\n        limitType: this.limitType,\n        quota: this.quota,\n        quotaUsed: this.quotaUsed,\n        startSaleNum: this.startSaleNum\n      });\n    },\n    onChange: function onChange(currentValue) {\n      var intValue = parseInt(currentValue, 10);\n      var handleStepperChange = this.customStepperConfig.handleStepperChange;\n      handleStepperChange && handleStepperChange(intValue);\n      this.$emit('change', intValue);\n    },\n    checkState: function checkState(min, max) {\n      // 如果选择小于起售，则强制变为起售\n      if (this.currentNum < min || min > max) {\n        this.currentNum = min;\n      } else if (this.currentNum > max) {\n        // 当前选择数量大于最大可选时，需要重置已选数量\n        this.currentNum = max;\n      }\n\n      this.skuEventBus.$emit('sku:stepperState', {\n        valid: min <= max,\n        min: min,\n        max: max,\n        limitType: this.limitType,\n        quota: this.quota,\n        quotaUsed: this.quotaUsed,\n        startSaleNum: this.startSaleNum\n      });\n    }\n  },\n  render: function render() {\n    var _this = this;\n\n    var h = arguments[0];\n    return h(\"div\", {\n      \"class\": \"van-sku-stepper-stock\"\n    }, [h(\"div\", {\n      \"class\": \"van-sku__stepper-title\"\n    }, [this.stepperTitle || t('num')]), h(Stepper, {\n      \"attrs\": {\n        \"integer\": true,\n        \"min\": this.stepperMinLimit,\n        \"max\": this.stepperLimit,\n        \"disableInput\": this.disableStepperInput\n      },\n      \"class\": \"van-sku__stepper\",\n      \"on\": {\n        \"overlimit\": this.onOverLimit,\n        \"change\": this.onChange\n      },\n      \"model\": {\n        value: _this.currentNum,\n        callback: function callback($$v) {\n          _this.currentNum = $$v;\n        }\n      }\n    }), !this.hideQuotaText && this.quotaText && h(\"span\", {\n      \"class\": \"van-sku__stepper-quota\"\n    }, [\"(\", this.quotaText, \")\"])]);\n  }\n});"]},"metadata":{},"sourceType":"module"}