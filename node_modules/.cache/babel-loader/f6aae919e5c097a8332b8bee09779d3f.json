{"ast":null,"code":"import \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport { createNamespace, addUnit } from '../utils';\nimport { deepClone } from '../utils/deep-clone';\nimport { preventDefault } from '../utils/dom/event';\nimport { range, addNumber } from '../utils/format/number';\nimport { TouchMixin } from '../mixins/touch';\nimport { FieldMixin } from '../mixins/field';\n\nvar _createNamespace = createNamespace('slider'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1];\n\nvar isSameValue = function isSameValue(newValue, oldValue) {\n  return JSON.stringify(newValue) === JSON.stringify(oldValue);\n};\n\nexport default createComponent({\n  mixins: [TouchMixin, FieldMixin],\n  props: {\n    disabled: Boolean,\n    vertical: Boolean,\n    range: Boolean,\n    barHeight: [Number, String],\n    buttonSize: [Number, String],\n    activeColor: String,\n    inactiveColor: String,\n    min: {\n      type: [Number, String],\n      default: 0\n    },\n    max: {\n      type: [Number, String],\n      default: 100\n    },\n    step: {\n      type: [Number, String],\n      default: 1\n    },\n    value: {\n      type: [Number, Array],\n      default: 0\n    }\n  },\n  data: function data() {\n    return {\n      dragStatus: ''\n    };\n  },\n  computed: {\n    scope: function scope() {\n      return this.max - this.min;\n    },\n    buttonStyle: function buttonStyle() {\n      if (this.buttonSize) {\n        var size = addUnit(this.buttonSize);\n        return {\n          width: size,\n          height: size\n        };\n      }\n    }\n  },\n  created: function created() {\n    // format initial value\n    this.updateValue(this.value);\n  },\n  mounted: function mounted() {\n    if (this.range) {\n      this.bindTouchEvent(this.$refs.wrapper0);\n      this.bindTouchEvent(this.$refs.wrapper1);\n    } else {\n      this.bindTouchEvent(this.$refs.wrapper);\n    }\n  },\n  methods: {\n    onTouchStart: function onTouchStart(event) {\n      if (this.disabled) {\n        return;\n      }\n\n      this.touchStart(event);\n      this.currentValue = this.value;\n\n      if (this.range) {\n        this.startValue = this.value.map(this.format);\n      } else {\n        this.startValue = this.format(this.value);\n      }\n\n      this.dragStatus = 'start';\n    },\n    onTouchMove: function onTouchMove(event) {\n      if (this.disabled) {\n        return;\n      }\n\n      if (this.dragStatus === 'start') {\n        this.$emit('drag-start');\n      }\n\n      preventDefault(event, true);\n      this.touchMove(event);\n      this.dragStatus = 'draging';\n      var rect = this.$el.getBoundingClientRect();\n      var delta = this.vertical ? this.deltaY : this.deltaX;\n      var total = this.vertical ? rect.height : rect.width;\n      var diff = delta / total * this.scope;\n\n      if (this.range) {\n        this.currentValue[this.index] = this.startValue[this.index] + diff;\n      } else {\n        this.currentValue = this.startValue + diff;\n      }\n\n      this.updateValue(this.currentValue);\n    },\n    onTouchEnd: function onTouchEnd() {\n      if (this.disabled) {\n        return;\n      }\n\n      if (this.dragStatus === 'draging') {\n        this.updateValue(this.currentValue, true);\n        this.$emit('drag-end');\n      }\n\n      this.dragStatus = '';\n    },\n    onClick: function onClick(event) {\n      event.stopPropagation();\n      if (this.disabled) return;\n      var rect = this.$el.getBoundingClientRect();\n      var delta = this.vertical ? event.clientY - rect.top : event.clientX - rect.left;\n      var total = this.vertical ? rect.height : rect.width;\n      var value = +this.min + delta / total * this.scope;\n\n      if (this.range) {\n        var _this$value = this.value,\n            left = _this$value[0],\n            right = _this$value[1];\n        var middle = (left + right) / 2;\n\n        if (value <= middle) {\n          left = value;\n        } else {\n          right = value;\n        }\n\n        value = [left, right];\n      }\n\n      this.startValue = this.value;\n      this.updateValue(value, true);\n    },\n    // 处理两个滑块重叠之后的情况\n    handleOverlap: function handleOverlap(value) {\n      if (value[0] > value[1]) {\n        value = deepClone(value);\n        return value.reverse();\n      }\n\n      return value;\n    },\n    updateValue: function updateValue(value, end) {\n      if (this.range) {\n        value = this.handleOverlap(value).map(this.format);\n      } else {\n        value = this.format(value);\n      }\n\n      if (!isSameValue(value, this.value)) {\n        this.$emit('input', value);\n      }\n\n      if (end && !isSameValue(value, this.startValue)) {\n        this.$emit('change', value);\n      }\n    },\n    format: function format(value) {\n      var min = +this.min;\n      var max = +this.max;\n      var step = +this.step;\n      value = range(value, min, max);\n      var diff = Math.round((value - min) / step) * step;\n      return addNumber(min, diff);\n    }\n  },\n  render: function render() {\n    var _wrapperStyle,\n        _this = this,\n        _barStyle;\n\n    var h = arguments[0];\n    var vertical = this.vertical;\n    var mainAxis = vertical ? 'height' : 'width';\n    var crossAxis = vertical ? 'width' : 'height';\n    var wrapperStyle = (_wrapperStyle = {\n      background: this.inactiveColor\n    }, _wrapperStyle[crossAxis] = addUnit(this.barHeight), _wrapperStyle); // 计算选中条的长度百分比\n\n    var calcMainAxis = function calcMainAxis() {\n      var value = _this.value,\n          min = _this.min,\n          range = _this.range,\n          scope = _this.scope;\n\n      if (range) {\n        return (value[1] - value[0]) * 100 / scope + \"%\";\n      }\n\n      return (value - min) * 100 / scope + \"%\";\n    }; // 计算选中条的开始位置的偏移量\n\n\n    var calcOffset = function calcOffset() {\n      var value = _this.value,\n          min = _this.min,\n          range = _this.range,\n          scope = _this.scope;\n\n      if (range) {\n        return (value[0] - min) * 100 / scope + \"%\";\n      }\n\n      return null;\n    };\n\n    var barStyle = (_barStyle = {}, _barStyle[mainAxis] = calcMainAxis(), _barStyle.left = this.vertical ? null : calcOffset(), _barStyle.top = this.vertical ? calcOffset() : null, _barStyle.background = this.activeColor, _barStyle);\n\n    if (this.dragStatus) {\n      barStyle.transition = 'none';\n    }\n\n    var renderButton = function renderButton(i) {\n      var map = ['left', 'right'];\n      var isNumber = typeof i === 'number';\n      var current = isNumber ? _this.value[i] : _this.value;\n\n      var getClassName = function getClassName() {\n        if (isNumber) {\n          return \"button-wrapper-\" + map[i];\n        }\n\n        return \"button-wrapper\";\n      };\n\n      var getRefName = function getRefName() {\n        if (isNumber) {\n          return \"wrapper\" + i;\n        }\n\n        return \"wrapper\";\n      };\n\n      var renderButtonContent = function renderButtonContent() {\n        if (isNumber) {\n          var slot = _this.slots(i === 0 ? 'left-button' : 'right-button', {\n            value: current\n          });\n\n          if (slot) {\n            return slot;\n          }\n        }\n\n        if (_this.slots('button')) {\n          return _this.slots('button');\n        }\n\n        return h(\"div\", {\n          \"class\": bem('button'),\n          \"style\": _this.buttonStyle\n        });\n      };\n\n      return h(\"div\", {\n        \"ref\": getRefName(),\n        \"attrs\": {\n          \"role\": \"slider\",\n          \"tabindex\": _this.disabled ? -1 : 0,\n          \"aria-valuemin\": _this.min,\n          \"aria-valuenow\": _this.value,\n          \"aria-valuemax\": _this.max,\n          \"aria-orientation\": _this.vertical ? 'vertical' : 'horizontal'\n        },\n        \"class\": bem(getClassName()),\n        \"on\": {\n          \"touchstart\": function touchstart() {\n            if (isNumber) {\n              // 保存当前按钮的索引\n              _this.index = i;\n            }\n          },\n          \"click\": function click(e) {\n            return e.stopPropagation();\n          }\n        }\n      }, [renderButtonContent()]);\n    };\n\n    return h(\"div\", {\n      \"style\": wrapperStyle,\n      \"class\": bem({\n        disabled: this.disabled,\n        vertical: vertical\n      }),\n      \"on\": {\n        \"click\": this.onClick\n      }\n    }, [h(\"div\", {\n      \"class\": bem('bar'),\n      \"style\": barStyle\n    }, [this.range ? [renderButton(0), renderButton(1)] : renderButton()])]);\n  }\n});","map":{"version":3,"sources":["C:/Users/Lisp/Desktop/items/node_modules/vant/es/slider/index.js"],"names":["createNamespace","addUnit","deepClone","preventDefault","range","addNumber","TouchMixin","FieldMixin","_createNamespace","createComponent","bem","isSameValue","newValue","oldValue","JSON","stringify","mixins","props","disabled","Boolean","vertical","barHeight","Number","String","buttonSize","activeColor","inactiveColor","min","type","default","max","step","value","Array","data","dragStatus","computed","scope","buttonStyle","size","width","height","created","updateValue","mounted","bindTouchEvent","$refs","wrapper0","wrapper1","wrapper","methods","onTouchStart","event","touchStart","currentValue","startValue","map","format","onTouchMove","$emit","touchMove","rect","$el","getBoundingClientRect","delta","deltaY","deltaX","total","diff","index","onTouchEnd","onClick","stopPropagation","clientY","top","clientX","left","_this$value","right","middle","handleOverlap","reverse","end","Math","round","render","_wrapperStyle","_this","_barStyle","h","arguments","mainAxis","crossAxis","wrapperStyle","background","calcMainAxis","calcOffset","barStyle","transition","renderButton","i","isNumber","current","getClassName","getRefName","renderButtonContent","slot","slots","touchstart","click","e"],"mappings":"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","sourcesContent":["import { createNamespace, addUnit } from '../utils';\nimport { deepClone } from '../utils/deep-clone';\nimport { preventDefault } from '../utils/dom/event';\nimport { range, addNumber } from '../utils/format/number';\nimport { TouchMixin } from '../mixins/touch';\nimport { FieldMixin } from '../mixins/field';\n\nvar _createNamespace = createNamespace('slider'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1];\n\nvar isSameValue = function isSameValue(newValue, oldValue) {\n  return JSON.stringify(newValue) === JSON.stringify(oldValue);\n};\n\nexport default createComponent({\n  mixins: [TouchMixin, FieldMixin],\n  props: {\n    disabled: Boolean,\n    vertical: Boolean,\n    range: Boolean,\n    barHeight: [Number, String],\n    buttonSize: [Number, String],\n    activeColor: String,\n    inactiveColor: String,\n    min: {\n      type: [Number, String],\n      default: 0\n    },\n    max: {\n      type: [Number, String],\n      default: 100\n    },\n    step: {\n      type: [Number, String],\n      default: 1\n    },\n    value: {\n      type: [Number, Array],\n      default: 0\n    }\n  },\n  data: function data() {\n    return {\n      dragStatus: ''\n    };\n  },\n  computed: {\n    scope: function scope() {\n      return this.max - this.min;\n    },\n    buttonStyle: function buttonStyle() {\n      if (this.buttonSize) {\n        var size = addUnit(this.buttonSize);\n        return {\n          width: size,\n          height: size\n        };\n      }\n    }\n  },\n  created: function created() {\n    // format initial value\n    this.updateValue(this.value);\n  },\n  mounted: function mounted() {\n    if (this.range) {\n      this.bindTouchEvent(this.$refs.wrapper0);\n      this.bindTouchEvent(this.$refs.wrapper1);\n    } else {\n      this.bindTouchEvent(this.$refs.wrapper);\n    }\n  },\n  methods: {\n    onTouchStart: function onTouchStart(event) {\n      if (this.disabled) {\n        return;\n      }\n\n      this.touchStart(event);\n      this.currentValue = this.value;\n\n      if (this.range) {\n        this.startValue = this.value.map(this.format);\n      } else {\n        this.startValue = this.format(this.value);\n      }\n\n      this.dragStatus = 'start';\n    },\n    onTouchMove: function onTouchMove(event) {\n      if (this.disabled) {\n        return;\n      }\n\n      if (this.dragStatus === 'start') {\n        this.$emit('drag-start');\n      }\n\n      preventDefault(event, true);\n      this.touchMove(event);\n      this.dragStatus = 'draging';\n      var rect = this.$el.getBoundingClientRect();\n      var delta = this.vertical ? this.deltaY : this.deltaX;\n      var total = this.vertical ? rect.height : rect.width;\n      var diff = delta / total * this.scope;\n\n      if (this.range) {\n        this.currentValue[this.index] = this.startValue[this.index] + diff;\n      } else {\n        this.currentValue = this.startValue + diff;\n      }\n\n      this.updateValue(this.currentValue);\n    },\n    onTouchEnd: function onTouchEnd() {\n      if (this.disabled) {\n        return;\n      }\n\n      if (this.dragStatus === 'draging') {\n        this.updateValue(this.currentValue, true);\n        this.$emit('drag-end');\n      }\n\n      this.dragStatus = '';\n    },\n    onClick: function onClick(event) {\n      event.stopPropagation();\n      if (this.disabled) return;\n      var rect = this.$el.getBoundingClientRect();\n      var delta = this.vertical ? event.clientY - rect.top : event.clientX - rect.left;\n      var total = this.vertical ? rect.height : rect.width;\n      var value = +this.min + delta / total * this.scope;\n\n      if (this.range) {\n        var _this$value = this.value,\n            left = _this$value[0],\n            right = _this$value[1];\n        var middle = (left + right) / 2;\n\n        if (value <= middle) {\n          left = value;\n        } else {\n          right = value;\n        }\n\n        value = [left, right];\n      }\n\n      this.startValue = this.value;\n      this.updateValue(value, true);\n    },\n    // 处理两个滑块重叠之后的情况\n    handleOverlap: function handleOverlap(value) {\n      if (value[0] > value[1]) {\n        value = deepClone(value);\n        return value.reverse();\n      }\n\n      return value;\n    },\n    updateValue: function updateValue(value, end) {\n      if (this.range) {\n        value = this.handleOverlap(value).map(this.format);\n      } else {\n        value = this.format(value);\n      }\n\n      if (!isSameValue(value, this.value)) {\n        this.$emit('input', value);\n      }\n\n      if (end && !isSameValue(value, this.startValue)) {\n        this.$emit('change', value);\n      }\n    },\n    format: function format(value) {\n      var min = +this.min;\n      var max = +this.max;\n      var step = +this.step;\n      value = range(value, min, max);\n      var diff = Math.round((value - min) / step) * step;\n      return addNumber(min, diff);\n    }\n  },\n  render: function render() {\n    var _wrapperStyle,\n        _this = this,\n        _barStyle;\n\n    var h = arguments[0];\n    var vertical = this.vertical;\n    var mainAxis = vertical ? 'height' : 'width';\n    var crossAxis = vertical ? 'width' : 'height';\n    var wrapperStyle = (_wrapperStyle = {\n      background: this.inactiveColor\n    }, _wrapperStyle[crossAxis] = addUnit(this.barHeight), _wrapperStyle); // 计算选中条的长度百分比\n\n    var calcMainAxis = function calcMainAxis() {\n      var value = _this.value,\n          min = _this.min,\n          range = _this.range,\n          scope = _this.scope;\n\n      if (range) {\n        return (value[1] - value[0]) * 100 / scope + \"%\";\n      }\n\n      return (value - min) * 100 / scope + \"%\";\n    }; // 计算选中条的开始位置的偏移量\n\n\n    var calcOffset = function calcOffset() {\n      var value = _this.value,\n          min = _this.min,\n          range = _this.range,\n          scope = _this.scope;\n\n      if (range) {\n        return (value[0] - min) * 100 / scope + \"%\";\n      }\n\n      return null;\n    };\n\n    var barStyle = (_barStyle = {}, _barStyle[mainAxis] = calcMainAxis(), _barStyle.left = this.vertical ? null : calcOffset(), _barStyle.top = this.vertical ? calcOffset() : null, _barStyle.background = this.activeColor, _barStyle);\n\n    if (this.dragStatus) {\n      barStyle.transition = 'none';\n    }\n\n    var renderButton = function renderButton(i) {\n      var map = ['left', 'right'];\n      var isNumber = typeof i === 'number';\n      var current = isNumber ? _this.value[i] : _this.value;\n\n      var getClassName = function getClassName() {\n        if (isNumber) {\n          return \"button-wrapper-\" + map[i];\n        }\n\n        return \"button-wrapper\";\n      };\n\n      var getRefName = function getRefName() {\n        if (isNumber) {\n          return \"wrapper\" + i;\n        }\n\n        return \"wrapper\";\n      };\n\n      var renderButtonContent = function renderButtonContent() {\n        if (isNumber) {\n          var slot = _this.slots(i === 0 ? 'left-button' : 'right-button', {\n            value: current\n          });\n\n          if (slot) {\n            return slot;\n          }\n        }\n\n        if (_this.slots('button')) {\n          return _this.slots('button');\n        }\n\n        return h(\"div\", {\n          \"class\": bem('button'),\n          \"style\": _this.buttonStyle\n        });\n      };\n\n      return h(\"div\", {\n        \"ref\": getRefName(),\n        \"attrs\": {\n          \"role\": \"slider\",\n          \"tabindex\": _this.disabled ? -1 : 0,\n          \"aria-valuemin\": _this.min,\n          \"aria-valuenow\": _this.value,\n          \"aria-valuemax\": _this.max,\n          \"aria-orientation\": _this.vertical ? 'vertical' : 'horizontal'\n        },\n        \"class\": bem(getClassName()),\n        \"on\": {\n          \"touchstart\": function touchstart() {\n            if (isNumber) {\n              // 保存当前按钮的索引\n              _this.index = i;\n            }\n          },\n          \"click\": function click(e) {\n            return e.stopPropagation();\n          }\n        }\n      }, [renderButtonContent()]);\n    };\n\n    return h(\"div\", {\n      \"style\": wrapperStyle,\n      \"class\": bem({\n        disabled: this.disabled,\n        vertical: vertical\n      }),\n      \"on\": {\n        \"click\": this.onClick\n      }\n    }, [h(\"div\", {\n      \"class\": bem('bar'),\n      \"style\": barStyle\n    }, [this.range ? [renderButton(0), renderButton(1)] : renderButton()])]);\n  }\n});"]},"metadata":{},"sourceType":"module"}